<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Aura â€” Personal Assistant</title>
  <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/4712/4712100.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
  tailwind.config = {
    theme: {
      extend: {
        colors: {
          accent1: '#00f0d1',
          accent2: '#ff2ec4',
          accent3: '#6ea8ff',
          muted: '#a8f0ee33',
        },
        boxShadow: {
          glass: '0 10px 40px rgba(11,14,26,0.6)',
          neon: '0 12px 60px rgba(0,0,0,0.6)',
        },
      }
    }
  }
  </script>
  <style>
  body {
    background:
      radial-gradient(800px 400px at 20% 20%, rgba(0, 255, 255, 0.15), transparent 70%),
      radial-gradient(700px 300px at 80% 80%, rgba(59, 130, 246, 0.12), transparent 70%),
      #001322;
  }
  .typewriter { display:inline-block; white-space:pre-wrap; overflow:hidden; }
  .orb::after {
    content:'';
    position:absolute;
    inset:0;
    border-radius:9999px;
    background: conic-gradient(from 120deg, rgba(0,240,209,0.06), rgba(110,168,255,0.03));
    mix-blend-mode: screen;
  }
  </style>
</head>

<body class="text-white flex justify-center min-h-screen items-start py-10">

<div class="grid grid-cols-1 md:grid-cols-[360px_1fr] gap-6 w-full max-w-6xl px-4">

  <!-- LEFT PANEL -->
  <aside class="bg-white/5 border border-white/10 rounded-2xl p-6 shadow-glass relative overflow-hidden min-h-[520px] flex flex-col items-center">
    <div class="flex flex-col items-center gap-4 mt-2">
      <div id="orb" class="orb relative w-40 h-40 rounded-full border border-accent3/20 flex items-center justify-center shadow-inner transition-transform duration-200">
        <div class="absolute inset-[-8px] rounded-full opacity-0 scale-90 transition-all duration-200"></div>
        <div class="orb-icon w-[86px] h-[86px] rounded-full bg-white/5 flex items-center justify-center text-accent3 font-bold text-lg">AURA</div>
      </div>
      <div id="statusText" class="text-xs text-[var(--muted)] text-center opacity-70">Ready â€” say "Open browser" or "Open YouTube"</div>
    </div>
  </aside>

  <!-- RIGHT PANEL -->
  <section class="bg-white/5 border border-cyan-400/10 rounded-2xl p-4 flex flex-col shadow-neon min-h-[520px]">
    <div class="flex items-center justify-between mb-3">
      <div class="text-lg font-bold flex items-center gap-2">
        AI Aura <span class="text-xs text-[var(--muted)] font-semibold">â€¢ Live Assistant</span>
      </div>
      <div id="chip" class="bg-gradient-to-r from-accent1/20 to-accent3/10 px-3 py-1 text-xs rounded-full border border-accent1/10 text-[var(--muted)]">Voice: Female</div>
    </div>

    <div id="chatbox-area" class="flex-1 overflow-auto flex flex-col gap-2 p-3"></div>

    <div class="mt-3 flex gap-2 items-center p-3 rounded-xl bg-white/5 border border-cyan-400/10">
      <input id="inputField" class="flex-1 bg-transparent outline-none text-cyan-100 text-sm p-2" placeholder="Type or press ðŸŽ¤ to speak..." autocomplete="off" />
      <button id="sendBtn" class="bg-gradient-to-r from-accent2 to-accent1 px-4 py-2 rounded-lg text-[#001726] font-bold shadow-md">Send</button>
      <button id="micBtn" class="bg-gradient-to-r from-accent2 to-accent1 px-4 py-2 rounded-lg text-[#001726] font-bold shadow-md">ðŸŽ¤</button>
    </div>
  </section>
</div>

<script>
// ------------------- VOICE SETUP -------------------
let voicesReady=false, femaleVoice=null;
function loadVoices(){
  let vs=speechSynthesis.getVoices();
  if(vs.length===0){ setTimeout(loadVoices,200); return; }
  voicesReady=true;
  femaleVoice=vs.find(v=>v.name.toLowerCase().includes('zira')||v.name.toLowerCase().includes('samantha')||v.name.toLowerCase().includes('female'));
}
loadVoices();
speechSynthesis.onvoiceschanged=loadVoices;

function speak(text){
  if(!('speechSynthesis' in window)) return;
  if(!voicesReady) loadVoices();
  const u=new SpeechSynthesisUtterance(text);
  u.lang='en-US';
  if(femaleVoice) u.voice=femaleVoice;
  if(speechSynthesis.speaking) speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

// ------------------- CHAT -------------------
const chatArea=document.getElementById('chatbox-area');
function addAssistantMessageTyped(txt) {
  const el = document.createElement('div');
  el.className =
    'self-start bg-white/10 border-l-2 border-accent1/30 p-3 rounded-xl text-cyan-50 max-w-[78%] shadow-md';
  const tw = document.createElement('span');
  tw.className = 'typewriter';
  el.appendChild(tw);
  chatArea.appendChild(el);
  chatArea.scrollTop = chatArea.scrollHeight;

  let i = 0,
    speed = 18;
  function type() {
    tw.innerHTML = txt.slice(0, i);
    i++;
    chatArea.scrollTop = chatArea.scrollHeight;
    if (i <= txt.length) {
      setTimeout(type, speed);
    } else {
      // âœ… Style all hyperlinks as clear clickable buttons
      const links = tw.querySelectorAll('a');
      links.forEach((link) => {
        link.className =
          'inline-block mt-2 px-3 py-1 bg-gradient-to-r from-accent1 to-accent3 text-[#001726] font-semibold rounded-lg shadow-md hover:scale-105 transition-transform duration-150';
        const domain = link.href.split('/')[2].replace('www.', '');
        link.innerHTML = 'ðŸ‘‰ Click here to open ' + domain.charAt(0).toUpperCase() + domain.slice(1);
      });

      // âœ… Voice should not include emoji or URLs
      const plainText = tw.textContent
        .replace(/ðŸ‘‰/g, '')        // remove icon
        .replace(/https?:\/\/\S+/g, '') // remove URL
        .trim();
      if (plainText) speak(plainText);
    }
  }
  type();
}
// ------------------- MESSAGE SENDER -------------------
const input=document.getElementById('inputField');
const sendBtn=document.getElementById('sendBtn');
const micBtn=document.getElementById('micBtn');

function addUserMessage(txt){
  const el=document.createElement('div');
  el.className='self-end bg-gradient-to-br from-[#00c6ff] to-[#0072ff] p-3 rounded-xl text-[#001726] max-w-[72%] shadow-lg';
  el.textContent=txt;
  chatArea.appendChild(el);
  chatArea.scrollTop=chatArea.scrollHeight;
}

async function sendCommand(commandText){
  if(!commandText) return;
  addUserMessage(commandText);
  input.value='';

  try{
    const res=await fetch('/command',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({command:commandText})
    });
    const data=await res.json();
    addAssistantMessageTyped(data.response);
  }catch(e){
    addAssistantMessageTyped('âš  Unable to reach the server.');
  }
}

sendBtn.addEventListener('click',()=>{const t=input.value.trim();if(t)sendCommand(t);});
input.addEventListener('keydown',(e)=>{if(e.key==='Enter'){const t=input.value.trim();if(t)sendCommand(t);}});

function startListening(){
  if(!('SpeechRecognition' in window || 'webkitSpeechRecognition' in window)){
    alert('Speech recognition not supported.');
    return;
  }
  const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
  const recog=new SR();
  recog.lang='en-US';
  recog.onresult=(ev)=>{
    const text=ev.results[0][0].transcript;
    sendCommand(text);
  };
  recog.start();
}
micBtn.addEventListener('click',()=>startListening());
window.addEventListener('load',()=>{setTimeout(()=>addAssistantMessageTyped("Hi â€” I'm Aura. I can open your Browser, YouTube, or Answer any questions."),600);});
function prefill(txt){input.value=txt;input.focus();}

</script>
</body>
</html>